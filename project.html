<!-- 
Mollee Jain
DATE: 12/19/2014
COURSE: CS307
This html creates a lovely holiday scene! It includes:
  - a christmas tree (with a star on top and presents underneath)
  - a set of tracks and a train that moves around it
  - a TV
  - two couches
  - a set of transparent vases
  - a fire and mantle
  - string of lights

 -->
<html>
<head>
  <title>Happy holidays!</title>
  <style>
      /* feel free to style the canvas any way you want. If you want it to
      use the entire window, set width: 100% and height: 100%. */
      
      canvas {
        display: block;
        margin: 10px auto;
        width: 80%;
        height: 80%;
      }

      h1 {
        font-family: "Courier New", Courier, monospace;
        font-size: 30;
        font-weight:bold;
        text-align:center;
      }
      h2 {
        font-family: "Courier New", Courier, monospace;
        font-size: 24;

      }
      h3 {
        font-family: "Courier New", Courier, monospace;
        font-size: 20;
      }
      h4 {
        font-family: "Courier New", Courier, monospace;
        font-size: 18;
        font-weight: normal;
      }
      p {
        font-family: "Courier New", Courier, monospace;
        font-size: 14;
      }

      </style>
      <script src="http://cs.wellesley.edu/~cs307/threejs/libs/three.min.js"></script>
      <script src="http://cs.wellesley.edu/~cs307/threejs/libs/OrbitControls.js"></script>
      <script src="http://cs.wellesley.edu/~cs307/threejs/libs/tw.js"></script>
      <script src ="http://cs.wellesley.edu/~cs307/threejs/libs/dat.gui.min.js"></script>
      <script src="http://cs.wellesley.edu/~cs307/threejs/contrib/mjain2_christmasTree.js"></script>
      <script src="http://cs.wellesley.edu/~cs307/threejs/contrib/mjain2_lightsAndTV.js"></script>
      <script src="http://cs.wellesley.edu/~cs307/threejs/contrib/mjain2_fireplace.js"></script>
      <script src="http://cs.wellesley.edu/~cs307/threejs/contrib/mjain2_couch.js"></script>
      <script src="http://cs.wellesley.edu/~cs307/threejs/contrib/mjain2_vases.js"></script>
      <script src="http://cs.wellesley.edu/~cs307/threejs/contrib/mjain2_train.js"></script>

    </head>
    <body>

      <h1> | HAPPY HOLIDAYS! |</br>[by Mollee Jain]</h2>
      <h2> MY SCENE: </h2> 
      <h4> Happy Holidays! My scene shows a living room that is ready for the wintery nights and holiday spirit! Within this scene are a multitude of objects, all of them created using THREE.js and JavaScript.  The code that creates these objects can be found in relating JavaScript files that have been uploaded to the contrib folder of this course. Below is a list of all of the objects in the scene and a little description about each one. </h4>

      <h3> THE TREE </h3>
      <p> The tree, trunk and star at the top of the tree use a cylinder geometry and PhongMaterial.  The presents at the bottom of the tree are texture mapped and are created using a box geometry. The different parts of the tree are created and then added to a 3D Object. </p>

      <h3> THE TRAIN </h3>
      <p>  The train is modeled using different kinds of box geometry.  The train is all PhongMaterial, yet each box geometry has a different color associated with it.  The wheels of the train are created using a torus geometry, as are the train tracks. The train tracks are situated with the center point being the location of the chrismas tree in the scene.  The train is situated on top of the tracks, and is animated to go around the tracks.  </p>

      <h3> THE FIREPLACE </h3>
      <p>  The fireplace contains a mantle (created using box geometries and texture mapping) and a plane with a slightly transparent mapping of a fire.  The material used for the mantle is PhongMaterial and BasicMaterial for the fire plane.  The parameters to set the fireplace dimensions are defined in fireParams and are used for both the mantle and the plane construction. The mantle and fire is positioned in the middle of the back wall.  </p>

      <h3> THE LIGHTS AND THE TV </h3>
      <p>  Little string lights are placed along the top perimeter of the room. The string lights are white spheres (SphereGeom) with PhongMaterial that are repeated along the edges of the room.  Another part of the decor is the TV object, which is a boxGeometry with a transparent white plane overlaid on top of it.  The TV is found on the right wall, about halfway up.  </p>

      <img src="tree.png" alt="Tree,tracks, mantle, and TV" width="80%" align="center"></img>

      <h3> THE COUCHES </h3>
      <p>  Each individual couch is made up of different box geometries.  The material used throughout the model is PhongMaterial.  Each part of the couch (side, base, back, and cushions) have different parameters of width, height and depth. The couch is positioned on the left hand side against the wall.  A clone of this couch object is rotated and positioned in the center of the roomon the z axis (it's back is visible to the viewer when the scene first rendered).  </p>

      <h3> THE VASES </h3>
      <p>  A group of transparent vases were created and randomly put (coordinates are arbitrary) into an order that is aesthetically pleasing.  Each vase is a cylinder that can be altered (using the radius variables, the height variable, and the color variable.  Important to note: the position values were all randomly picked based on aesthetic appeal - those can be modified easily. Current position of the vases is in the front left corner of the room/bounding box.  </p>

       <img src="couch.png" alt="Couches and vases" width="80%" align="center"></img>

       <h3> View from left side (x-axis): </h3>
       <img src="viewx.png" alt="xaxis" width="80%" align="center"></img>
       <h3> View from above (y-axis): </h3>
       <img src="viewy.png" alt="yaxis" width="80%" align="center"></img>
       <h3> View from front (z-axis): </h3>
       <img src="viewz.png" alt="zaxis" width="80%" align="center"></img>

       <h1> DEMO: </h1>
<!-- 
**********************************************************************************************************
***************************** CREATE THE SCENE ***********************************************************
**********************************************************************************************************
-->

      <script id="scene-code">

      /* -------------------- INITIALIZATION ------------------------------*/
      var scene = new THREE.Scene(); //always need a scene and a renderer
      var renderer = new THREE.WebGLRenderer();
      TW.mainInit(renderer,scene); //initialize
      THREE.ImageUtils.crossOrigin = "anonymous"; //allows for proper loading of images

      //parameters of the room (width,height,depth) = bounding box
      var roomParams = {
        roomWallColor:"rgb(70,130,200)", //mute blue color (backup, in case texture fails)
        roomCeilingColor:"rgb(255,222,173)",//navajo 
        roomFloorColor: "rgb(240,160,90)", //sandy brown-ish color (backup, in case texture fails)
        roomWidth: 150, 
        roomHeight: 100,
        roomDepth: 150,
      };

      var t = 0; //used as a timestamp in animation

      //to allow for ease of position setting of camera and other objects
      var halfRoomHeight = roomParams.roomHeight/2;
      var halfRoomWidth = roomParams.roomWidth/2;
      var halfRoomDepth = roomParams.roomDepth/2;

      //define floor and wall textures
      var texture = new THREE.ImageUtils.loadTexture('brick.jpg',new THREE.UVMapping);
      var carpet = new THREE.ImageUtils.loadTexture('carpet.jpg',new THREE.UVMapping);
      var colorMaterials = [
        //right wall -  blue
        new THREE.MeshPhongMaterial({map: texture, color: roomParams.roomWallColor, side: THREE.BackSide}),  
        //left wall -  blue
        new THREE.MeshPhongMaterial({map: texture, color: roomParams.roomWallColor, side: THREE.BackSide}),  
        //ceiling - navajo
        new THREE.MeshPhongMaterial({ambient: roomParams.roomCeilingColor, color: roomParams.roomCeilingColor,side: THREE.BackSide}), 
        //floor - sandy brown
        new THREE.MeshPhongMaterial({map:carpet, color: roomParams.roomFloorColor, side: THREE.BackSide}), 
        //front wall (not visible when initially rendered)- blue
          new THREE.MeshPhongMaterial({map: texture,color: roomParams.roomWallColor, side: THREE.BackSide}),  
        //back wall (visible when initially rendered) - blue
         new THREE.MeshPhongMaterial({map: texture,color: roomParams.roomWallColor, side: THREE.BackSide}),  
      ];

    /* -------------------- ADD LIGHT TO THE SCENE ------------------------------*/

    /*  addLight()
    This adds ambient and directional light to the scene. The directional light position is set to a corner */
    function addLight() {
      var ambient = new THREE.AmbientLight("rgb(220,220,220)"); //gainsboro
      scene.add(ambient);
      var directional = new THREE.DirectionalLight("rgb(50,50,50)"); 
      //darker rgb for slight directional light in scene
      directional.position.set(50,50,100); //reset location of light source
      scene.add(directional);
    }

    /* -------------------- ADD OBJJECTS TO SCENE ------------------------------*/
    /* createBox(colors)
    This function creates the room.  A boxGeometry with the specified parameters is first created, then the material and color of the faces is set.  The boxMesh is created then added to the scene.  See roomParams for specified paramters  */
    function createBox(colors) {
      var geom = new THREE.BoxGeometry(roomParams.roomWidth,roomParams.roomHeight,roomParams.roomDepth); //100,100,100 box
      var faces = new THREE.MeshFaceMaterial(colors); //phong material
      var boxMesh = new THREE.Mesh(geom,faces); 
      scene.add(boxMesh); //add box to the scene
    };

    /* createTreeAndTracks()
    This function creates the tree, train, and tracks and adds them to the scene (after positioning them).  The
    train object is returned so it can later be animated  */
    function createTreeAndTracks() {
      var treeAndTrain = new THREE.Object3D();
      var tree = christmasTree(roomParams);
      var train = createTrain();  
      var trainTracks = tracks();
      treeAndTrain.add(tree);
      treeAndTrain.add(train);
      treeAndTrain.add(trainTracks);
      scene.add(treeAndTrain);
      treeAndTrain.position.set(halfRoomWidth*(.5),0,-halfRoomDepth*(0.4));
      //renderTrain(t,train);
      return train;
    }

    /* drawScene()
    This function creates the scene.  It creates the room, the train & tree & tracks, string lights, the mantle & fire,
    the couches, the TV, and the vases.  Light is also added here.  */
    function drawScene() {
      createBox(colorMaterials);
      var trainObject = createTreeAndTracks();
      createStringLights(halfRoomWidth,halfRoomHeight,halfRoomDepth);
      createMantle(roomParams);
      addLight();
      createCouch(roomParams);
      createTV(roomParams);
      createVases(roomParams);
      return trainObject; //use for animation
    }

    var train = drawScene(); //draws the scene and obtains the train object used for animation
    window.onload = TW.render; //render only after everything has been loaded (ie. textures)
    
    //set up camera
    var camera = TW.cameraSetup(renderer,
                 scene,
                 {minx: -halfRoomWidth, maxx: halfRoomWidth,
                  miny: -halfRoomHeight, maxy: halfRoomHeight,
                  minz: -halfRoomDepth,maxz: halfRoomDepth});

  /* -------------------- ANIMATE THE TRAIN ------------------------------*/
    /* UPDATE()
    This function updates the train's position in the scene using the helper renderTrain method. */
    function update (train) {
      function renderTrain(t,train) {
        if(t<100) { //gives animation an eventual stopping point
          t+=0.01; //arbitrary time units
          train.rotation.y += 0.03; //rotates train object 
          train.position.x = Math.cos(t) + 0; //moves train object along x axis
          train.position.z = Math.sin(t) + 0; //moves train object along y axis
          renderer.render(scene,camera.cameraObject); 
         }
      }
      renderTrain(t,train); //renders the new positin of the train
    }

    /* animate()
    This function uses update and render() to animate the train. */
    function animate () {
     update(train); //updates the train's position
     TW.render(); //renders the scene
     animationID = requestAnimationFrame(animate);
    }

    animate();
    //END OF SCRIPT
    </script>

</body>
</html>
